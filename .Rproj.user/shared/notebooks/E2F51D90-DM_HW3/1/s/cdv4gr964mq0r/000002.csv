"0","# From the text: http://daviddalpiaz.github.io/appliedstats/variable-selection-and-model-building.html"
"0","calc_loocv_rmse = function(model) {"
"0","  sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))"
"0","}"
"0","calc_rmse = function(actual, predicted) {"
"0","  sqrt(sum((actual - predicted)^2) / length(actual)) "
"0","}"
"0","calc_avg_per_error = function(actual, predicted) {"
"0","    inter_abs = abs(predicted - actual)"
"0","    100 * (sum(inter_abs / actual)) / length(actual)"
"0","}"
"0",""
"0","#for my models - full, step 2_way model, 3_way model"
"0",""
"0","full_loocv_rmse = calc_loocv_rmse(step_full_mod_finish_aic)"
"0","twoway_loocv_rmse = calc_loocv_rmse(step_twoway_mod_finish_aic)"
"0","threeway_loocv_rmse = calc_loocv_rmse(full_threeway_model)"
"0",""
"0","loocv_rmse_results = data.frame("
"0","  ""LOOCV-RMSE"" ="
"0","    c(""Step full"" = full_loocv_rmse,"
"0","      ""Step Two-Way-Log"" = twoway_loocv_rmse,"
"0","      ""Initial Three-way"" = threeway_loocv_rmse))"
"0",""
"0","kable(loocv_rmse_results)"
