load(USArrests)
#PCA - unsuervised learning examples
dimnames(USArrests)
#PCA - unsuervised learning examples
data(USArrests)
dimnames(USArrests)
apply(USArrests,2,mean)
apply(USArrests,2,var)
#standardize with pca.our
pca.out=prcomp(USArrests, scale=TRUE)
pca.out
head(USArrests)
#visualize PC
biplot(pca.out, scale=0)
#visualize PC
biplot(pca.out, scale=0, cex=0.6)
install.packages("GGally")
install.packages("LICORS")
knitr::opts_chunk$set(echo = TRUE,
warning=FALSE,
message=FALSE,
echo=FALSE)
library(tidyverse)
library(corrplot)
library(gridExtra)
library(GGally)
library(LICORS)
wine <- read.csv("C:/Users/anuka/Desktop/Spring 2021/ECO 395M - DATA MINING/Data/wine.csv")
View(wine)
library(skimr)
#data exploration
skim(wine)
biplot(pca.out)
head(wine)
kable(head(wine))
library(kableExtra)
kable(head(wine))
#data visualization
## Density plot for each Attribute
wines %>%
gather(Attributes, value, 1:13) %>%
ggplot(aes(x=value, fill=Attributes)) +
geom_density(colour="black", alpha=0.6, show.legend=FALSE) +
facet_wrap(~Attributes, scales="free_x") +
labs(x="Values", y="Density",
title="Wines Attributes - Density plots") +
theme_bw()
#data visualization
## Density plot for each Attribute
wine %>%
gather(Attributes, value, 1:13) %>%
ggplot(aes(x=value, fill=Attributes)) +
geom_density(colour="black", alpha=0.6, show.legend=FALSE) +
facet_wrap(~Attributes, scales="free_x") +
labs(x="Values", y="Density",
title="Wines Attributes - Density plots") +
theme_bw()
wine %>%
gather(Attributes, value, 1:13) %>%
ggplot(aes(x=value, fill=Attributes)) +
geom_histogram(colour="black", alpha=0.6, show.legend=FALSE) +
facet_wrap(~Attributes, scales="free_x") +
labs(x="Values", y="Density",
title="Wines Attributes - Density plots") +
theme_bw()
#data visualization
## histogram plot for each Attribute
wine %>%
gather(Attributes, value, 1:13) %>%
ggplot(aes(x=value, fill=Attributes)) +
geom_histogram(colour="black", show.legend=FALSE) +
facet_wrap(~Attributes, scales="free_x") +
labs(x="Values", y="Frequency",
title="Wines Attributes - Histograms") +
theme_bw()
#data visualization
## histogram plot for each Attribute
wine %>%
gather(Attributes, value, 1:13) %>%
ggplot(aes(x=value, fill=Attributes)) +
geom_boxplot(colour="black", show.legend=FALSE) +
facet_wrap(~Attributes, scales="free_x") +
labs(x="Values", y="Frequency",
title="Wines Attributes - Histograms") +
theme_bw()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:4, 6:12)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, 1:13) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:13)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:4,6:12)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
wine %>%
gather(Attributes, value, 1:13) %>%
ggplot(aes(x=value, fill=Attributes)) +
geom_histogram(colour="black", show.legend=FALSE) +
facet_wrap(~Attributes, scales="free_x") +
labs(x="Values", y="Frequency",
title="Wines Attributes - Histograms") +
theme_bw()
wine %>%
gather(Attributes, value, 1:13) %>%
ggplot(aes(x=value, fill=Attributes)) +
geom_histogram(colour="black", show.legend=FALSE, stat="count") +
facet_wrap(~Attributes, scales="free_x") +
labs(x="Values", y="Frequency",
title="Wines Attributes - Histograms") +
theme_bw()
#standardize
stand_wine=prcomp(wine, scale=TRUE, center=TRUE)
#standardize
stand_wine=prcomp(wine, scale=TRUE, center=TRUE, na.rm=na.omit)
head(cars)
data(cars)
head(cars)
#standardize
X<-unlist(lapply(wine, is.numeric))
stand_wine=prcomp(X, scale=TRUE, center=TRUE, na.rm=na.omit)
kable(head(stand_wine))
head(stand_wine)
# Boxplot for each Attribute
stand_wine %>%
gather(Attributes, values, c(1:4,6:12)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:5,6:12)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:12)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:13)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:12)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Correlation matrix
corrplot(cor(wine), type="upper", method="ellipse", tl.cex=0.9)
# Correlation matrix
corrplot(cor(X), type="upper", method="ellipse", tl.cex=0.9)
head(X)
#standardize
data_num<-wine[,num_cols]
data_num<-wine[,X]
# Correlation matrix
corrplot(cor(data_num), type="upper", method="ellipse", tl.cex=0.9)
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="pearson", tl.cex=0.9)
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=0.9)
#standardize
X<-unlist(lapply(wine, is.numeric))
wine_num<-wine[,X]
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=0.9)
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=0.9)
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=0.5)
corrplot(cor(wine_num), type="upper", method="square", tl.cex=0.5)
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=1.5)
corrplot(cor(wine_num), type="upper", method="square", tl.cex=1.5)
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=1)
corrplot(cor(wine_num), type="upper", method="square", tl.cex=1)
attributes(wine$color)
wine_clean<-wine%>%mutate(color=factor(color))
# Correlation matrix
corrplot(cor(wine_clean), type="upper", method="square", tl.cex=1)
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=1)
attributes(wine$color)
levels(wine$color) <- list("red"="1","white"="2")
attributes(wine$color)
# Correlation matrix
corrplot(cor(wine), type="upper", method="square", tl.cex=1)
summary(wine)
wine<-as.factor(wine$color)
head(wine)
wine<-wine%>%mutate(as.factor(wine$color))
wine$color<-as.factor(wine$color)
#LOAD DATA
wine <- read.csv("C:/Users/anuka/Desktop/Spring 2021/ECO 395M - DATA MINING/Data/wine.csv")
#data exploration
#skim(wine) - 0 missing variables 1 character,12 numeric
kable(head(wine))
wine$color<-as.factor(wine$color)
# Correlation matrix
corrplot(cor(wine), type="upper", method="square", tl.cex=1)
skim(wine)
prop(wine, color==1)
library(dplyr)
prop(wine, color==1)
ggplot(wine)+aes(x=color,fill="color")+geom_bar()
ggplot(wine)+aes(x=color)+geom_bar(fill="color")
ggplot(wine)+aes(x=color)+geom_bar()
ggplot(wine)+aes((x=color), fill="color")+geom_bar()
ggplot(wine)+aes((x=color), fill=color)+geom_bar()
#create numeric wine df
X<-unlist(lapply(wine, is.numeric))
wine_num<-wine[,X]
stand_wine=prcomp(X, scale=TRUE, center=TRUE, na.rm=na.omit)
# Boxplot for each Attribute
wine %>%
gather(Attributes, values, c(1:12)) %>%
ggplot(aes(x=reorder(Attributes, values, FUN=median), y=values, fill=Attributes)) +
geom_boxplot(show.legend=FALSE) +
labs(title="Wines Attributes - Boxplots") +
theme_bw() +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank()) +
ylim(0, 35) +
coord_flip()
# Correlation matrix
corrplot(cor(wine_num), type="upper", method="square", tl.cex=1)
corrplot(cor(wine_num), type="upper", method="square", tl.cex=1)
names(wine)
# Relationship between alcohol and density
ggplot(wine, aes(x=alcohol, y=density)) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
labs(title="Wines Attributes",
subtitle="Relationship between Alcohol and Density") +
theme_bw()
ggplot(wine, aes(x=alcohol, y=density)) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
labs(title="Wines Attributes",
subtitle="Relationship between Alcohol and Density") +
theme_bw()
ggplot(wines, aes(x=free.sulfur.dioxide, y=total.sulfur.dioxide)) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
labs(title="Wines Attributes",
subtitle="Relationship between Total Sulfur Dioxide and Free Sulfur Dioxide") +
theme_bw()
ggplot(wine, aes(x=free.sulfur.dioxide, y=total.sulfur.dioxide)) +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
labs(title="Wines Attributes",
subtitle="Relationship between Total Sulfur Dioxide and Free Sulfur Dioxide") +
theme_bw()
#normalization
wine_norm <- as.data.frame(scale(wine))
#normalization
wine_norm <- as.data.frame(scale(wine_num))
#k-means execution
set.seed(12347)
##k-means with k=2
wine_k2 <- kmeans(wine_norm, centers=2)
#normalization
wine_norm <- as.data.frame(scale(wine_num, center=TRUE, scale=TRUE))
#k-means execution
set.seed(12347)
##k-means with k=2
wine_k2 <- kmeans(wine_norm, centers=2)
##check what is in what cluster
which(clust1$cluster == 1)
##check what is in what cluster
which(wine_k2$cluster == 1)
which(wine_k2$cluster == 2)
#cluster size
wine_k2$size
# A few plots with cluster membership shown
qplot(quality, alcohol, data=wine_norm, color=factor(wine_k2$cluster))
# A few plots with cluster membership shown
qplot(quality, data=wine_norm, color=factor(wine_k2$cluster))
#normalization
wine_norm <- as.data.frame(scale(wine_num, center=TRUE, scale=TRUE))
#k-means execution
set.seed(12347)
##k-means with k=2
wine_k2 <- kmeans(wine_norm, centers=3)
#cluster size
wine_k2$size
##check what is in what cluster
which(wine_k2$cluster == 1)
which(wine_k2$cluster == 2)
# A few plots with cluster membership shown
qplot(quality, data=wine_norm, color=factor(wine_k2$cluster))
#normalization
wine_norm <- as.data.frame(scale(wine_num, center=TRUE, scale=TRUE))
#k-means execution
set.seed(12347)
##k-means with k=2
wine_k2 <- kmeans(wine_norm, centers=10)
#cluster size
wine_k2$size
##check what is in what cluster
which(wine_k2$cluster == 1)
which(wine_k2$cluster == 2)
# A few plots with cluster membership shown
qplot(quality, data=wine_norm, color=factor(wine_k2$cluster))
##k-means with k=2
wine_k2 <- kmeans(wine_norm, centers=2)
# Using kmeans++ initialization
wine_k2plus = kmeanspp(wine_norm, centers=2)
# Using kmeans++ initialization
wine_k2plus = kmeanspp(wine_norm, k=2)
#normalization
wine_norm <- as.data.frame(scale(wine_num, center=TRUE, scale=TRUE))
#k-means execution
set.seed(12347)
##k-means with k=2
wine_k2 <- kmeans(wine_norm, centers=2)
# Using kmeans++ initialization
wine_k2plus = kmeanspp(wine_norm, k=2)
#cluster size
wine_k2$size
wine_k2plus = kmeanspp(wine_norm, k=2)
#between cluster sum of squares
wine_k2$betweenss
# Within-cluster sum of squares
wine_k2$withinss
# Total within-cluster sum of squares
wines_k2$tot.withinss
#normalization
wine_norm <- as.data.frame(scale(wine_num, center=TRUE, scale=TRUE))
#k-means execution
set.seed(12347)
##k-means with k=2
wine_k2 <- kmeans(wine_norm, centers=2)
# Using kmeans++ initialization
wine_k2plus = kmeanspp(wine_norm, k=2)
#cluster size
wine_k2$size
wine_k2plus = kmeanspp(wine_norm, k=2)
#between cluster sum of squares
wine_k2$betweenss
# Within-cluster sum of squares
wine_k2$withinss
# Total within-cluster sum of squares
wine_k2$tot.withinss
##check what is in what cluster
which(wine_k2$cluster == 1)
which(wine_k2$cluster == 2)
# A few plots with cluster membership shown
qplot(quality, data=wine_norm, color=factor(wine_k2$cluster))
qplot(quality, data=wine_norm, color=factor(wine_k2plus$cluster))
library(foreach)
k_grid=seq(2,20,by=1)
SSE_grid=foreach(k=k_grid,.combine="c")%>%{cluster_k=kmeans(wine_norm,k,nstart=50)
cluster_k$tot.withinss}
library(foreach)
k_grid=seq(2,20,by=1)
SSE_grid=foreach(k = k_grid,.combine="c")%>%{cluster_k=kmeans(wine_norm,k,nstart=50)
cluster_k$tot.withinss}
library(foreach)
k_grid=seq(2,20,by=1)
SSE_grid=foreach (k=k_grid,.combine="c")%do%{cluster_k=kmeans(wine_norm,k,nstart=50)
cluster_k$tot.withinss}
k_grid=seq(2,20,by=1)
SSE_grid=foreach (k=k_grid,.combine="c")%do%{cluster_k=kmeans(wine_norm,k,nstart=50)
cluster_k$tot.withinss}
qplot(2:20, SSE_grid, geom=c("point", "line"),
xlab="Number of clusters", ylab="Total within-cluster sum of squares") +
scale_x_continuous(breaks=seq(0, 10, 1)) +
theme_bw()
qplot(2:20, SSE_grid, geom=c("point", "line"),
xlab="Number of clusters", ylab="Total within-cluster sum of squares") +
scale_x_continuous(breaks=seq(0, 10, 1)) +
theme_bw()
# k-means with k=3
set.seed(5789)
wine_k3 <- kmeans(wine_norm, centers=3)
# Mean values of each cluster
aggregate(wine, by=list(wine_k3$cluster), mean)
# Clustering
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:6, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
# Clustering
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:6, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
```
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:6, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
# Clustering
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:6, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
# Clustering
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:13, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
# Clustering
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:6, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
# Clustering
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:6, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw(),
# Clustering
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=1:6, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=6:13, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
ggpairs(cbind(wine, Cluster=as.factor(wine_k3$cluster)),
columns=6:13, aes(colour=Cluster, alpha=0.5),
lower=list(continuous="points"),
upper=list(continuous="blank"),
axisLabels="none", switch="both") +
theme_bw()
